<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Functions - Four invocation patterns</title>
  <style> .container { margin-bottom: 30px; }</style>
</head>
<body>
  <div class="container">
    <div id="item-1"></div>
    <div id="item-2"></div>
  </div>
  <div class="container">
    <div id="item-3"></div>
  </div>
  <div class="container">
    <div id="item-4"></div>
  </div>
  <div class="container">
    <div id="item-5"></div>
  </div>
  <script>
  /**
   * Function Literal
   */

   var add = function(a, b) {
    return a + b;
   };

   document.getElementById('item-1').innerHTML = add(2,5);

   // ==========================================================================
   // JavaScript functions is how different invocation 
   // patterns can produce vastly different results.
   // ==========================================================================

   /**
   * Patterns of invocation:
   * 1 - Method invocation
   * 2 - Function invocation 
   * 3 - Constructor invocation 
   * 4 - Apply invocation 
   */

   //
   // 1- Method invocation
   // ==========================================================================
   var obj = {
    value: 0,
    increment: function(o) {
      this.value += typeof o === 'number' ? o : 1;
    }
   }

   obj.increment(); //Method invocation

   document.getElementById('item-2').innerHTML = "Method invocation: " + obj.value;


   //
   // 2 - Function Invocation - is performed by invoking a function using ()
   // ==========================================================================
   var sum = add(10,10); /* When a function is invoked with this pattern, this is bound to the global object. */

   document.getElementById('item-3').innerHTML = "Invoked function: " + sum;

   var value = 200;

   var myObj = {
    value: 0,

    increment: function() {
      var th = this; // For the 'this' not be global.
      th.value++;

      var innerFunction = function () {
        alert(th.value);
      }

      innerFunction(); //Function invocation ( When using the function invocation pattern, this is set to the global object an soluctions is use for example: var th = this; )
    }

   }

   myObj.increment();


   //
   // 3 - Constructor Invocation
   // ==========================================================================
   function shape(brand) {
    this.brand = brand;
   }

   var myShape = new shape("Flip");

   document.getElementById("item-4").innerHTML = "The brand of my shape is: " + myShape.brand;

   //
   // 4 - Apply invocation 
   // ==========================================================================
   var arr, that;

   function add(a, b) {
    return a * b;
   }

   arr = [2, 10];

   // The apply method takes two parameters: The first is the value that should be bound to this. The second is an array of parameters.
   that = add.apply(null, arr);
   document.getElementById('item-5').innerHTML = "Apply invocation: " + that;

  </script>
</body>
</html>
